# ğŸ¤– AIæŠ¥å‘Šå¢å¼ºåŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

AIæŠ¥å‘Šå¢å¼ºåŠŸèƒ½é€šè¿‡é›†æˆå¤§å‹è¯­è¨€æ¨¡å‹(LLM)ï¼Œä¸ºæ•°æ®åˆ†ææŠ¥å‘Šæä¾›æ™ºèƒ½æ´å¯Ÿã€æ·±åº¦è§£è¯»å’Œä¸“ä¸šå»ºè®®ã€‚ç³»ç»Ÿæ”¯æŒå¤šç§AIæä¾›å•†ï¼Œå¯ä»¥åœ¨ç”ŸæˆæŠ¥å‘Šå‰å¯¹åˆ†æç»“æœè¿›è¡ŒAIä¼˜åŒ–ã€‚

## ğŸŒŸ ä¸»è¦ç‰¹æ€§

### ğŸ”§ æ”¯æŒçš„AIæä¾›å•†
- **OpenAI**: GPT-3.5-turboã€GPT-4ç³»åˆ—
- **é€šä¹‰åƒé—®**: qwen-turboã€qwen-plusã€qwen-max
- **ChatGLM**: chatglm3-6bã€chatglm4
- **æœ¬åœ°æ¨¡å‹**: Ollamaç­‰æœ¬åœ°éƒ¨ç½²æ¨¡å‹

### ğŸ¯ å¢å¼ºç±»å‹
1. **ç»¼åˆåˆ†æ (comprehensive)**: å…¨é¢çš„æ´å¯Ÿã€å»ºè®®å’Œè§£é‡Š
2. **æ·±åº¦æ´å¯Ÿ (insights)**: ä¸“æ³¨äºæ•°æ®æ¨¡å¼å’Œè¶‹åŠ¿å‘ç°
3. **è¡ŒåŠ¨å»ºè®® (recommendations)**: åŸºäºåˆ†æç»“æœæä¾›å…·ä½“å»ºè®®
4. **ç»“æœè§£è¯» (interpretation)**: ç”¨é€šä¿—è¯­è¨€è§£é‡Šç»Ÿè®¡ç»“æœ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒé…ç½®

#### å®‰è£…ä¾èµ–
```bash
pip install openai>=1.0.0 requests>=2.31.0
```

#### é…ç½®APIå¯†é’¥
1. å¤åˆ¶é…ç½®æ–‡ä»¶:
```bash
cp .env.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„APIå¯†é’¥:
```env
# OpenAIé…ç½®
OPENAI_API_KEY=sk-your-openai-key-here

# é€šä¹‰åƒé—®é…ç½®  
QWEN_API_KEY=your-qwen-key-here

# ChatGLMé…ç½®
CHATGLM_API_KEY=your-chatglm-key-here
```

### 2. å¯ç”¨AIå¢å¼º

#### åœ¨Webç•Œé¢ä¸­é…ç½®
1. å¯åŠ¨åº”ç”¨: `streamlit run src/ui/app.py`
2. åœ¨å·¦ä¾§è¾¹æ æ‰¾åˆ° "ğŸ¤– AIæŠ¥å‘Šå¢å¼º" é…ç½®åŒºåŸŸ
3. å‹¾é€‰ "å¯ç”¨AIæŠ¥å‘Šå¢å¼º"
4. é€‰æ‹©AIæä¾›å•†å’Œæ¨¡å‹
5. è¾“å…¥APIå¯†é’¥ï¼ˆæˆ–é…ç½®æœ¬åœ°æ¨¡å‹åœ°å€ï¼‰
6. é€‰æ‹©å¢å¼ºç±»å‹
7. ç‚¹å‡» "ğŸ”§ æµ‹è¯•AIè¿æ¥" éªŒè¯é…ç½®

#### ç¨‹åºåŒ–é…ç½®
```python
from src.ai_agent.ai_report_enhancer import create_ai_enhancer, AIModelConfig

# æ–¹å¼1: ä½¿ç”¨ä¾¿æ·å‡½æ•°
enhancer = create_ai_enhancer(
    provider="openai",
    model_name="gpt-3.5-turbo", 
    api_key="your-api-key"
)

# æ–¹å¼2: ä½¿ç”¨é…ç½®ç±»
config = AIModelConfig(
    provider="qwen",
    model_name="qwen-turbo",
    api_key="your-qwen-key",
    max_tokens=4000,
    temperature=0.7
)
enhancer = AIReportEnhancer(config)
```

### 3. ç”ŸæˆAIå¢å¼ºæŠ¥å‘Š

#### é€šè¿‡Webç•Œé¢
1. ä¸Šä¼ æ•°æ®å¹¶å®Œæˆåˆ†æ
2. è¿›å…¥ "ğŸ“„ æŠ¥å‘Šç”Ÿæˆ" é¡µé¢
3. ç¡®ä¿AIå¢å¼ºå·²å¯ç”¨å¹¶é…ç½®æ­£ç¡®
4. ç‚¹å‡» "ğŸš€ ç”Ÿæˆæ™ºèƒ½åˆ†ææŠ¥å‘Š"
5. ç³»ç»Ÿå°†è‡ªåŠ¨ä½¿ç”¨AIå¯¹åˆ†æç»“æœè¿›è¡Œå¢å¼º

#### ç¨‹åºåŒ–ä½¿ç”¨
```python
from src.report_generation.report_generator import AdvancedReportGenerator

# åˆ›å»ºæŠ¥å‘Šç”Ÿæˆå™¨
report_gen = AdvancedReportGenerator()

# è®¾ç½®AIå¢å¼ºå™¨
report_gen.set_ai_enhancer(enhancer)

# ç”ŸæˆæŠ¥å‘Š
saved_path = report_gen.generate_full_report(
    data=your_data,
    analysis_results=your_analysis_results,
    charts=your_charts,
    file_info=file_info
)
```

## ğŸ“Š AIå¢å¼ºç¤ºä¾‹

### åŸå§‹åˆ†æç»“æœ
```
ç›¸å…³æ€§åˆ†æç»“æœ:
- å¹´é¾„ä¸æ”¶å…¥ç›¸å…³ç³»æ•°: r = 0.45, p < 0.01
- æ»¡æ„åº¦ä¸æ”¶å…¥ç›¸å…³ç³»æ•°: r = 0.32, p < 0.05
```

### AIå¢å¼ºåçš„å†…å®¹
```
ğŸ¤– AIæ™ºèƒ½åˆ†æ

ğŸ” æ·±å±‚æ´å¯Ÿ:
1. **å…³é”®å‘ç°æ€»ç»“**: æ•°æ®æ˜¾ç¤ºå¹´é¾„ä¸æ”¶å…¥å­˜åœ¨ä¸­ç­‰å¼ºåº¦æ­£ç›¸å…³(r=0.45)ï¼Œ
   è¡¨æ˜éšç€å¹´é¾„å¢é•¿ï¼Œæ”¶å…¥æ°´å¹³é€šå¸¸ä¼šæå‡ï¼Œè¿™ç¬¦åˆèŒä¸šå‘å±•çš„ä¸€èˆ¬è§„å¾‹ã€‚

2. **å®é™…æ„ä¹‰**: å¹´é¾„å› ç´ è§£é‡Šäº†çº¦20%çš„æ”¶å…¥å˜å¼‚ï¼Œæç¤ºç»éªŒç§¯ç´¯å¯¹
   æ”¶å…¥å¢é•¿å…·æœ‰é‡è¦ä½œç”¨ã€‚æ»¡æ„åº¦ä¸æ”¶å…¥çš„å…³è”è™½ç„¶è¾ƒå¼±ï¼Œä½†ä»å…·ç»Ÿè®¡æ„ä¹‰ã€‚

3. **å»ºè®®æªæ–½**: 
   - å»ºè®®å…³æ³¨å¹´è½»å‘˜å·¥çš„èŒä¸šå‘å±•è·¯å¾„è®¾è®¡
   - è€ƒè™‘å»ºç«‹åŸºäºç»éªŒçš„è–ªé…¬ä½“ç³»
   - æ¢ç´¢é™¤æ”¶å…¥å¤–å½±å“æ»¡æ„åº¦çš„å…¶ä»–å› ç´ 

4. **å±€é™æ€§è¯´æ˜**: åˆ†æåŸºäºæ¨ªæˆªé¢æ•°æ®ï¼Œæ— æ³•ç¡®å®šå› æœå…³ç³»ã€‚å»ºè®®
   ç»“åˆçºµå‘è¿½è¸ªæ•°æ®è¿›è¡Œæ›´æ·±å…¥çš„åˆ†æã€‚
```

## ğŸ”§ é«˜çº§é…ç½®

### è‡ªå®šä¹‰AIæç¤ºè¯
```python
# åœ¨ai_report_enhancer.pyä¸­ä¿®æ”¹_build_enhancement_promptæ–¹æ³•
def _build_enhancement_prompt(self, data_summary, results_summary, enhancement_type):
    # è‡ªå®šä¹‰æ‚¨çš„æç¤ºè¯æ¨¡æ¿
    custom_prompt = f"""
    ä½œä¸º{your_domain}é¢†åŸŸçš„ä¸“å®¶ï¼Œè¯·åŸºäºä»¥ä¸‹æ•°æ®åˆ†æç»“æœ...
    """
    return custom_prompt
```

### é…ç½®ä¸åŒæ¨¡å‹å‚æ•°
```python
config = AIModelConfig(
    provider="openai",
    model_name="gpt-4",
    max_tokens=6000,        # æœ€å¤§è¾“å‡ºé•¿åº¦
    temperature=0.3,        # åˆ›é€ æ€§æ§åˆ¶(0-1)
    timeout=60             # è¶…æ—¶æ—¶é—´(ç§’)
)
```

### æœ¬åœ°æ¨¡å‹é…ç½®
```python
# ä½¿ç”¨Ollamaç­‰æœ¬åœ°æ¨¡å‹
config = AIModelConfig(
    provider="local",
    model_name="llama2",
    api_base="http://localhost:11434/api/generate",
    max_tokens=4000,
    temperature=0.7
)
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. AIå¢å¼ºåŠŸèƒ½ä¸å¯ç”¨
**ç—‡çŠ¶**: ä¾§è¾¹æ æ²¡æœ‰AIå¢å¼ºé€‰é¡¹  
**è§£å†³**: 
- æ£€æŸ¥æ˜¯å¦å®‰è£…äº† `openai` å’Œ `requests` ä¾èµ–
- ç¡®è®¤AIå¢å¼ºæ¨¡å—å¯¼å…¥æˆåŠŸ

#### 2. APIè¿æ¥å¤±è´¥
**ç—‡çŠ¶**: æµ‹è¯•è¿æ¥å¤±è´¥æˆ–æŠ¥å‘Šç”Ÿæˆæ—¶å‡ºé”™  
**è§£å†³**:
- éªŒè¯APIå¯†é’¥æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- ç¡®è®¤APIé…é¢æ˜¯å¦å……è¶³
- å¯¹äºå›½å†…ç”¨æˆ·ï¼Œå¯èƒ½éœ€è¦é…ç½®ä»£ç†

#### 3. å“åº”è´¨é‡ä¸ä½³
**ç—‡çŠ¶**: AIç”Ÿæˆçš„å†…å®¹ä¸å‡†ç¡®æˆ–ä¸ç›¸å…³  
**è§£å†³**:
- è°ƒæ•´temperatureå‚æ•°(é™ä½å€¼æé«˜å‡†ç¡®æ€§)
- å°è¯•æ›´é«˜çº§çš„æ¨¡å‹(å¦‚GPT-4)
- æ£€æŸ¥è¾“å…¥æ•°æ®çš„è´¨é‡
- ä¼˜åŒ–æç¤ºè¯æ¨¡æ¿

#### 4. å“åº”é€Ÿåº¦æ…¢
**ç—‡çŠ¶**: AIå¢å¼ºåŠŸèƒ½æ‰§è¡Œæ—¶é—´è¿‡é•¿  
**è§£å†³**:
- å‡å°‘max_tokenså‚æ•°
- ä½¿ç”¨æ›´å¿«çš„æ¨¡å‹(å¦‚gpt-3.5-turbo)
- å¢åŠ timeoutè®¾ç½®
- è€ƒè™‘ä½¿ç”¨æœ¬åœ°æ¨¡å‹

### è°ƒè¯•æ¨¡å¼
```python
import logging
logging.basicConfig(level=logging.DEBUG)

# å¯ç”¨è¯¦ç»†æ—¥å¿—
logger = logging.getLogger('src.ai_agent.ai_report_enhancer')
logger.setLevel(logging.DEBUG)
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æç¤ºè¯ä¼˜åŒ–
- æ˜ç¡®æŒ‡å®šè¾“å‡ºæ ¼å¼å’Œè¦æ±‚
- æä¾›ç›¸å…³é¢†åŸŸèƒŒæ™¯ä¿¡æ¯
- é™åˆ¶è¾“å‡ºé•¿åº¦é¿å…è¶…æ—¶

### 2. æ¨¡å‹é€‰æ‹©
- **é€Ÿåº¦ä¼˜å…ˆ**: gpt-3.5-turbo, qwen-turbo
- **è´¨é‡ä¼˜å…ˆ**: gpt-4, qwen-max
- **æˆæœ¬ä¼˜åŒ–**: æœ¬åœ°æ¨¡å‹, å¼€æºæ¨¡å‹

### 3. æ‰¹å¤„ç†ä¼˜åŒ–
```python
# å¯¹å¤šä¸ªåˆ†æç»“æœè¿›è¡Œæ‰¹é‡å¢å¼º
results = []
for result in analysis_results_list:
    enhanced = enhancer.enhance_analysis_results(data, result)
    results.append(enhanced)
```

## ğŸ”’ å®‰å…¨è€ƒè™‘

### 1. APIå¯†é’¥å®‰å…¨
- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨å¯†é’¥
- ä¸åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥
- å®šæœŸè½®æ¢APIå¯†é’¥

### 2. æ•°æ®éšç§
- æ•æ„Ÿæ•°æ®è„±æ•åå†å‘é€ç»™AI
- äº†è§£AIæä¾›å•†çš„æ•°æ®å¤„ç†æ”¿ç­–
- è€ƒè™‘ä½¿ç”¨æœ¬åœ°æ¨¡å‹å¤„ç†æ•æ„Ÿæ•°æ®

### 3. å†…å®¹å®¡æŸ¥
- å¯¹AIç”Ÿæˆçš„å†…å®¹è¿›è¡Œäººå·¥å®¡æŸ¥
- è®¾ç½®å†…å®¹è¿‡æ»¤è§„åˆ™
- å»ºç«‹åé¦ˆæœºåˆ¶æ”¹è¿›è¾“å‡ºè´¨é‡

## ğŸ“š æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„AIæä¾›å•†
1. åœ¨ `AIModelConfig` ä¸­æ·»åŠ æ–°çš„provider
2. åœ¨ `_call_ai_model` æ–¹æ³•ä¸­æ·»åŠ APIè°ƒç”¨é€»è¾‘
3. æ›´æ–°UIé€‰é¡¹å’Œæ–‡æ¡£

### è‡ªå®šä¹‰å¢å¼ºç±»å‹
1. åœ¨ `_build_enhancement_prompt` ä¸­æ·»åŠ æ–°ç±»å‹
2. åœ¨ `_integrate_ai_response` ä¸­å¤„ç†æ–°ç±»å‹
3. æ›´æ–°UIé€‰æ‹©å™¨

### é›†æˆæ–°çš„åˆ†ææ¨¡å—
1. åœ¨ `_prepare_results_summary` ä¸­æ·»åŠ æ–°ç»“æœç±»å‹
2. ä¼˜åŒ–æç¤ºè¯æ¨¡æ¿
3. æµ‹è¯•å’ŒéªŒè¯è¾“å‡ºè´¨é‡

## ğŸ¯ æœ€ä½³å®è·µ

1. **é€æ­¥å¯ç”¨**: å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯æ•ˆæœ
2. **æˆæœ¬æ§åˆ¶**: ç›‘æ§APIä½¿ç”¨é‡å’Œè´¹ç”¨
3. **è´¨é‡æ£€éªŒ**: å»ºç«‹AIè¾“å‡ºçš„è´¨é‡è¯„ä¼°æ ‡å‡†
4. **ç”¨æˆ·åŸ¹è®­**: æ•™è‚²ç”¨æˆ·å¦‚ä½•è§£è¯»AIå¢å¼ºçš„å†…å®¹
5. **æŒç»­ä¼˜åŒ–**: æ ¹æ®ç”¨æˆ·åé¦ˆæ”¹è¿›æç¤ºè¯å’Œé…ç½®

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. è¿è¡Œ `python test_ai_enhancement.py` è¿›è¡Œè‡ªæ£€
3. å‚è€ƒæœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
4. è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿ

---

**ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¥æœŸ**: 2025å¹´11æœˆ5æ—¥  
**å…¼å®¹æ€§**: AIæ•°æ®åˆ†æç³»ç»Ÿ v2.0+