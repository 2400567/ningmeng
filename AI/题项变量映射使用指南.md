# 🎯 题项变量映射系统使用指南

## 📖 功能概述

题项变量映射系统是AI数据分析系统的新增功能，专门用于处理问卷调查数据中的题项映射问题。基于您提供的Cronbach信度分析结果，系统能够：

- **自动识别题项**：检测数据中的问卷题项（Q1, Q2等格式）
- **构念分组**：将题项按照理论构念进行分组（如绩效期望、努力期望等）
- **信度验证**：基于Cronbach α系数验证构念可靠性
- **变量重命名**：将原始题项名转换为标准化的变量名

## 🏗️ 支持的构念体系

基于UTAUT2理论框架，系统支持以下11个构念：

### 核心构念
| 构念名称 | 题项范围 | Cronbach α | 信度等级 |
|----------|----------|------------|----------|
| 绩效期望 | Q1-Q4 | 0.817 | 良好 |
| 努力期望 | Q5-Q8 | 0.750 | 可接受 |
| 社会影响 | Q9-Q12 | 0.676 | 需改进 |
| 促进条件 | Q13-Q16 | 0.785 | 良好 |

### 扩展构念
| 构念名称 | 题项范围 | Cronbach α | 信度等级 |
|----------|----------|------------|----------|
| 享乐动机 | Q17-Q19 | 0.773 | 良好 |
| 价值认知 | Q20-Q22 | 0.767 | 良好 |
| 技术信任 | Q23-Q25 | 0.778 | 良好 |
| 感知风险 | Q26-Q27 | 0.689 | 需改进 |
| 个体创新 | Q28-Q30 | 0.747 | 可接受 |
| 消费意愿 | Q31-Q34 | 0.817 | 良好 |
| 消费行为 | Q35-Q37 | 0.822 | 良好 |

## 🚀 使用流程

### 1. 启动系统
```bash
cd /workspaces/ningmeng/AI
streamlit run enhanced_app.py --server.port=8504 --server.headless=true
```
访问: http://localhost:8504

### 2. 上传模板
- 上传包含分析模板的PDF文件
- 系统会自动解析模板变量

### 3. 上传数据
- 上传包含问卷数据的CSV/Excel文件
- 数据格式要求：
  ```
  Q1_题目内容, Q2_题目内容, Q3_题目内容, ...
  5, 4, 3, ...
  4, 5, 4, ...
  ```

### 4. 启用题项映射
- 如果数据验证通过，会显示"启用题项变量映射"按钮
- 点击后系统会自动检测题项格式

### 5. 查看映射结果
系统会显示：
- **构念信度统计**：各构念的Cronbach α值和可靠性等级
- **题项分布**：每个构念包含的题项数量
- **映射预览**：显示数据列名到变量名的映射关系

### 6. 应用映射
- 点击"创建题项变量映射"生成映射关系
- 点击"应用题项映射并继续"将映射应用到数据
- 系统会自动重命名数据列

## 📋 映射规则

### 变量命名规则
- **格式**：`构念名称_题项编号`
- **示例**：
  - `Q1_我认为AI虚拟主播能提高购物效率` → `绩效期望_Q1`
  - `Q5_学习使用AI虚拟主播对我来说很容易` → `努力期望_Q5`
  - `Q31_我打算继续使用AI虚拟主播购物` → `消费意愿_Q31`

### 匹配逻辑
1. **精确匹配**：列名中包含完整题项标识（如"Q1", "Q2"）
2. **模糊匹配**：提取题项编号进行匹配
3. **手动映射**：系统无法自动匹配时提供手动选择

## 💡 演示数据

系统已生成完整的演示数据文件：

**文件名**：`utaut2_demo_data.csv`
**规模**：300样本 × 43变量
**内容**：
- 基本信息：答题序号、来源
- 人口统计：性别、年龄、学历、职业
- 37个UTAUT2题项（Q1-Q37）

## 🔧 技术特性

### 智能识别
- 自动检测问卷题项格式
- 支持中英文题项标识
- 容错处理不规范格式

### 信度验证
- 基于理论预期的Cronbach α值
- 自动标识信度等级
- 提供改进建议

### 数据兼容
- 支持CSV、Excel格式
- 自动编码检测
- 处理中文字符

### 错误处理
- 详细的错误信息显示
- 智能恢复建议
- 调试信息输出

## 📊 分析建议

### 信度改进
对于信度较低的构念（α < 0.7），建议：
1. **社会影响**（α=0.676）：检查题项表述，考虑删除或修改
2. **感知风险**（α=0.689）：题项较少，可考虑增加题项

### 后续分析
映射完成后可进行：
- **描述性统计**：各构念的均值、标准差
- **相关性分析**：构念间相关关系
- **因子分析**：验证构念结构
- **结构方程模型**：路径分析和假设检验

## 🎯 最佳实践

### 数据准备
1. 确保题项编号连续（Q1, Q2, Q3...）
2. 使用标准的Likert量表（1-5或1-7）
3. 题目描述清晰，避免歧义

### 映射检查
1. 验证映射结果的逻辑性
2. 检查构念题项数量是否合理
3. 确认信度水平满足要求

### 质量控制
1. 检查缺失值处理
2. 验证数据分布合理性
3. 进行预测试验证

## 🚨 常见问题

### Q1: 系统无法识别题项？
**解决方案**：
- 检查列名是否包含"Q"标识
- 确保题项编号格式正确
- 使用手动映射功能

### Q2: 信度过低怎么办？
**解决方案**：
- 检查题项内容一致性
- 考虑删除问题题项
- 增加相关题项

### Q3: 映射结果不准确？
**解决方案**：
- 使用手动选择功能
- 检查题项编号顺序
- 验证构念理论基础

## 📈 效果展示

使用题项变量映射后，您的数据将从：

**原始格式**：
```
Q1_我认为AI虚拟主播能提高购物效率, Q2_AI虚拟主播让我更快找到想要的商品, ...
```

**转换为**：
```
绩效期望_Q1, 绩效期望_Q2, 努力期望_Q5, 努力期望_Q6, ...
```

这样的标准化变量名便于：
- 自动化分析处理
- 结果解释和报告
- 跨研究对比分析
- 理论模型验证

---

📞 **需要帮助？** 访问 http://localhost:8504 开始使用，或查看系统内置的详细说明和示例。